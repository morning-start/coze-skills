# 一致性检查指南

## 概述

一致性检查确保项目文档与代码实现保持同步，防止文档脱节导致的理解和维护问题。

## 检查维度

### 1. 数据一致性

- **版本号**：代码版本与文档版本是否一致
- **配置参数**：配置文件中的参数与文档描述是否匹配
- **API 端点**：接口文档与实际路由是否一致
- **数据库结构**：ER 图与实际 Schema 是否匹配

### 2. 术语一致性

- **功能名称**：文档中的功能名称与代码中的命名是否一致
- **变量命名**：代码变量与文档引用是否统一
- **缩写规范**：全称和缩写是否统一使用

### 3. 功能一致性

- **功能描述**：文档描述的功能与实际实现是否一致
- **参数说明**：函数/方法的参数说明是否准确
- **返回值**：返回值说明是否与实际一致
- **异常处理**：异常处理说明是否完整

### 4. 状态一致性

- **生命周期状态**：文档状态与实际维护状态是否一致
- **废弃声明**：已废弃功能的文档是否同步标记

## 执行流程

### 1. 收集检查项

确定需要检查的文档和代码对应关系：

```
文档路径                    → 对应代码
-------------------------  ------------------
README.md                  → package.json, setup.py
ARCHITECTURE.md            → src/
docs/api/*.md              → routes/, controllers/
docs/database/*.md         → models/, migrations/
```

### 2. 逐项对比

使用以下检查方法：

**版本检查**：
```bash
# 对比版本号
grep -r "version" package.json
grep -r "版本" README.md
```

**API 检查**：
```bash
# 列出实际路由
grep -r "@router" routes/
# 对比文档中的路由列表
```

**数据库检查**：
```bash
# 列出实际表结构
sqlite3 db.sqlite3 ".schema"
# 对比 ER 图
```

### 3. 生成报告

记录所有不一致项：

| 问题类型 | 严重程度 | 位置 | 描述 | 建议 |
|----------|----------|------|------|------|
| 版本不一致 | 高 | README.md | 文档版本 1.0，代码 1.1 | 更新文档 |
| API 缺失 | 中 | api/user.md | 缺少 /user/profile 接口 | 补充文档 |

### 4. 修复问题

根据报告修复一致性问题，优先处理高严重程度问题。

## 检查频率

- **发布前**：每次版本发布前必须执行
- **重大变更**：代码结构或 API 变更后
- **定期检查**：每月一次全面检查

## 注意事项

- 一致性检查是文档更新的前置条件
- 自动化工具可辅助检查，但人工复核仍必要
- 保持检查记录，便于追踪问题
