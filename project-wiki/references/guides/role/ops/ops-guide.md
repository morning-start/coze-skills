# 运维/SRE 指南

## 目录

1. [角色定位](#角色定位)
2. [核心职责](#核心职责)
3. [必备文档](#必备文档)
4. [最佳实践](#最佳实践)
5. [相关模板](#相关模板)

---

## 角色定位

作为运维工程师/SRE，你是系统稳定性的守护者，负责：
- 部署和配置系统
- 监控系统运行状态
- 处理故障和告警
- 优化系统性能

**你的关注点**：
- ✅ 部署拓扑
- ✅ 资源需求
- ✅ 扩缩容策略
- ✅ 监控告警指标

---

## 核心职责

### 1. 部署架构设计

**产出**：部署架构图、资源清单

**内容要求**：
- 部署拓扑图
  - 网络拓扑
  - 服务拓扑
  - 数据流向
- 资源需求
  - CPU、内存、磁盘
  - 网络带宽
  - 存储空间
- 环境配置
  - 开发环境
  - 测试环境
  - 生产环境
- 部署步骤
  - 初始化
  - 配置
  - 启动

**模板**：[ops-runbook-template.md](ops-runbook-template.md)

---

### 2. 监控告警

**产出**：监控文档

**内容要求**：
- 监控指标
  - 系统指标（CPU、内存、磁盘）
  - 应用指标（QPS、延迟、错误率）
  - 业务指标（订单量、用户数）
- 告警规则
  - 告警阈值
  - 告警级别
  - 告警渠道
- 告警处理
  - 告警响应流程
  - 升级策略
  - 处理手册

---

### 3. 故障处理

**产出**：故障处理手册

**内容要求**：
- 故障等级
  - P0：严重故障
  - P1：重大故障
  - P2：一般故障
  - P3：轻微故障
- 故障排查流程
  - 故障定位
  - 故障分析
  - 故障修复
- 回滚流程
  - 回滚条件
  - 回滚步骤
  - 回滚验证

---

### 4. SLA/SLO 定义

**产出**：SLA 文档

**内容要求**：
- SLA（Service Level Agreement）
  - 可用性承诺
  - 性能承诺
  - 响应时间承诺
- SLO（Service Level Objective）
  - 目标值
  - 测量方法
  - 报告周期
- SLI（Service Level Indicator）
  - 具体指标
  - 计算方法
  - 数据来源

---

## 必备文档

### 1. 运维手册

**路径**：`wiki/06-参考文档/`

**命名规范**：`ops-runbook.md`

**内容**：
- 部署架构图
- 资源清单
- 部署步骤
- 扩缩容策略
- 监控告警
- 故障排查
- 回滚流程

**使用模板**：[ops-runbook-template.md](ops-runbook-template.md)

---

### 2. 监控文档

**路径**：`wiki/06-参考文档/`

**命名规范**：`monitoring.md`

**内容**：
- 监控指标
- 告警规则
- 告警处理流程

---

### 3. SLA 文档

**路径**：`wiki/06-参考文档/`

**命名规范**：`sla.md`

**内容**：
- SLA 定义
- SLO 目标
- SLI 指标

---

## 最佳实践

### ✅ 部署架构

1. **高可用设计**
   - 多副本部署
   - 自动故障转移
   - 异地容灾

2. **资源规划**
   - 合理评估资源需求
   - 预留扩展空间
   - 定期审查资源使用

3. **环境隔离**
   - 开发、测试、生产环境隔离
   - 配置差异化管理
   - 数据隔离

---

### ✅ 监控告警

1. **全链路监控**
   - 从入口到出口全链路
   - 关键节点覆盖
   - 日志关联

2. **告警分级**
   - P0：立即处理
   - P1：30 分钟内
   - P2：1 小时内
   - P3：4 小时内

3. **告警收敛**
   - 合并重复告警
   - 避免告警风暴
   - 智能降噪

---

### ✅ 故障处理

1. **快速定位**
   - 保留详细日志
   - 使用分布式追踪
   - 监控指标关联

2. **快速恢复**
   - 优先恢复服务
   - 再分析根因
   - 最后优化改进

3. **事后复盘**
   - 复盘会议
   - 生成故障报告
   - 制定改进计划

---

## 相关模板

### 运维手册模板

📄 [ops-runbook-template.md](ops-runbook-template.md)

**包含内容**：
- 部署架构图
- 资源清单
- 部署步骤
- 扩缩容策略
- 监控告警
- 故障排查
- 回滚流程

---

## 常见问题

### Q1: 运维手册应该包含哪些内容？

**A**：至少包含：
1. 部署架构图（网络拓扑、服务拓扑）
2. 资源清单（CPU、内存、磁盘）
3. 部署步骤（初始化、配置、启动）
4. 扩缩容策略
5. 监控告警（指标、规则、处理流程）
6. 故障排查流程
7. 回滚流程

### Q2: 如何设计监控指标？

**A**：
1. **系统指标**：CPU、内存、磁盘、网络
2. **应用指标**：QPS、延迟、错误率、吞吐量
3. **业务指标**：订单量、用户数、转化率
4. **自定义指标**：根据业务需求定制

### Q3: SLA、SLO、SLI 的区别是什么？

**A**：
- **SLA（Service Level Agreement）**：服务等级协议，与客户签订的承诺
- **SLO（Service Level Objective）**：服务等级目标，内部设定的目标值
- **SLI（Service Level Indicator）**：服务等级指标，具体测量指标

---

## 资源链接

- [SRE 最佳实践](https://sre.google/sre-book/)
- [监控告警设计](https://prometheus.io/docs/practices/alerting/)

---

**最后更新**：2024-02-19
