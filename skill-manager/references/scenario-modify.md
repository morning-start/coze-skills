---
name: scenario-modify
description: 修改技能场景指南，定义技能修改的完整流程，嵌入生命周期管理，包含版本更新策略
tags: [scenario, modify, lifecycle, maintenance, version-control]
---

# 场景：修改技能

本文档定义修改现有技能的完整流程，嵌入技能生命周期管理，包含版本自动更新策略。

---

## 场景概述

**适用场景**: 修改已发布的技能（修复错误、添加功能、优化描述）
**生命周期**: 开发(Develop) → 测试(Test) → 发布(Release) → 维护(Maintenance)
**预计耗时**: 15-45 分钟
**输出物**: 更新后的 SKILL.md + 新版本标签

---

## 第一步：查阅信息 (Research)

### 1.1 检查当前技能状态

**读取当前元信息**:
```bash
# 读取 SKILL.md 前言区
head -20 SKILL.md
```

**关键信息提取**:
```yaml
current_status:
  name: [skill-name]
  version: [current-version]
```

### 1.2 分析变更需求

**变更分类**:
| 变更类型 | 说明 | 版本更新 | 示例 |
|---------|------|---------|------|
| **Fix** | 错误修复 | patch +1 | 修复错别字、澄清描述 |
| **Feature** | 新增功能 | minor +1 | 添加新能力、新示例 |
| **Breaking** | 破坏性变更 | major +1 | 修改接口、删除能力 |

**变更分析模板**:
```yaml
变更分析:
  变更类型: [fix/feature/breaking]
  影响范围: [局部/全局]
  向后兼容: [是/否]
  需要更新:
    - [ ] 版本号
    - [ ] 使用示例
    - [ ] 注意事项
```

### 1.3 确定版本策略

**版本决策树**:
```
是否有破坏性变更？
├── 是 → major +1 (v1.0.0 → v2.0.0)
└── 否 → 是否有新功能？
    ├── 是 → minor +1 (v1.0.0 → v1.1.0)
    └── 否 → patch +1 (v1.0.0 → v1.0.1)
```

---

## 第二步：执行操作 (Execute)

### 阶段 1: 开发阶段 (Develop)

**准入条件**: 变更需求已明确，版本策略已确定
**目标**: 执行修改并更新元信息

**操作步骤**:
1. **备份原文件**
   ```bash
   cp SKILL.md SKILL.md.bak
   ```

2. **执行修改**
   - 修改目标内容
   - 同步更新关联内容
   - 保持格式一致性

3. **自动更新元信息**
   
   **版本号更新**:
   ```yaml
   # 原版本: v1.0.0
   # 变更类型: feature
   # 新版本: v1.1.0
   version: v1.1.0
   ```
   
**准出条件**:
- [ ] 修改内容完成
- [ ] 版本号已更新

### 阶段 2: 测试阶段 (Test)

**准入条件**: 开发阶段已完成
**目标**: 验证修改质量

**操作步骤**:
1. **变更影响检查**
   - [ ] 修改后技能仍然可用
   - [ ] 未引入新的问题
   - [ ] 向后兼容性（如适用）

2. **标准化检验**
   ```bash
   # 检查前言区字段完整性
   head -10 SKILL.md
   
   # 验证版本号格式
   grep "version:" SKILL.md
   ```

**准出条件**:
- [ ] 变更影响已评估
- [ ] 标准化检验通过

### 阶段 3: 发布阶段 (Release)

**准入条件**: 测试阶段已完成
**目标**: 发布新版本

**操作步骤**:
1. **最终确认版本号**
   ```yaml
   version: v1.1.0
       date: 2024-03-01
       type: initial
       changes: ["初始版本发布"]
     - version: v1.1.0
       date: 2024-03-15
       type: feature
       changes: ["新增数据验证功能"]
   ---
   ```

2. **创建新版本标签**
   ```bash
   git add SKILL.md
   git commit -m "feat(data-cleaner): 新增数据验证功能"
   git tag -a v1.1.0 -m "Release v1.1.0: 新增数据验证功能"
   ```

3. **更新 CHANGELOG.md**
   ```markdown
   ## v1.1.0 (2024-03-15)
   
   ### 新增
   - 新增数据验证功能
   - 优化示例说明
   
   ### 修改
   - 更新使用示例
   ```

**准出条件**:
- [ ] 新版本标签创建
- [ ] CHANGELOG 已更新

---

## 第三步：检查验收 (Validate)

### 3.1 版本更新检查

```yaml
检查清单:
  版本号:
    - [ ] 版本号已更新
    - [ ] 版本号格式正确 (vX.Y.Z)
    - [ ] 版本递增合理
```

### 3.2 兼容性检查

```yaml
检查清单:
  向后兼容:
    - [ ] 接口变更已说明（如有）
    - [ ] 破坏性变更已标记（如有）
    - [ ] 迁移指南已提供（如需要）
  
  依赖关系:
    - [ ] 依赖版本已更新（如需要）
    - [ ] 无循环依赖
```

### 3.3 最终验证

```bash
# 验证版本标签
git tag | grep v1.1.0

# 验证版本号更新
grep "version:" SKILL.md
```

---

## 版本更新策略详解

### Patch 更新 (v1.0.0 → v1.0.1)

**适用场景**:
- 修复文档错误
- 澄清模糊描述
- 修正示例错误
- 优化格式

**操作示例**:
```yaml
# 变更: 修复 description 中的错别字
version: v1.0.1
### Minor 更新 (v1.0.0 → v1.1.0)

**适用场景**:
- 添加新能力
- 添加新示例
- 扩展使用场景
- 优化现有功能

**操作示例**:
```yaml
# 变更: 添加数据验证功能
version: v1.1.0
```

### Major 更新 (v1.0.0 → v2.0.0)

**适用场景**:
- 修改接口定义
- 删除核心能力
- 重大架构调整
- 不兼容变更

**操作示例**:
```yaml
# 变更: 重构接口，不兼容旧版本
version: v2.0.0
```

---

## 完整示例

### 修改 data-cleaner 技能（添加新功能）

```bash
# ========== 第一步：查阅信息 ==========
# 当前版本: v1.0.0
# 变更需求: 添加数据验证功能
# 变更类型: feature → minor +1
# 目标版本: v1.1.0

# ========== 第二步：执行操作 ==========

# 阶段 1: 开发
cp SKILL.md SKILL.md.bak

# 修改 SKILL.md:
# 1. 在能力列表中添加 "数据验证"
# 2. 添加验证操作步骤
# 3. 添加验证示例
# 4. 更新版本号: v1.0.0 → v1.1.0

# 阶段 2: 测试
# 执行标准化检验

# 阶段 3: 发布
git add SKILL.md
git commit -m "feat(data-cleaner): 新增数据验证功能"
git tag -a v1.1.0 -m "Release v1.1.0: 新增数据验证功能"

# 更新 CHANGELOG.md
cat >> CHANGELOG.md << 'EOF'
## v1.1.0 (2024-03-15)

### 新增
- 新增数据验证功能
- 添加验证操作步骤
- 添加验证示例
EOF

# ========== 第三步：检查验收 ==========
# ✅ 版本号更新: v1.0.0 → v1.1.0
# ✅ 向后兼容: 是
# ✅ 质量评分达标
# ✅ 技能修改成功
```

---

## 常见问题

**Q1: 如何确定变更类型？**
- **Fix**: 仅修复错误，无功能变更
- **Feature**: 添加新功能，向后兼容
- **Breaking**: 破坏性变更，可能不兼容

**Q2: 可以同时有多个变更类型吗？**
- 优先使用最高级别的变更类型
- Breaking > Feature > Fix
- 在 changes 列表中详细说明

**Q3: 修改后发现错误怎么办？**
- 如果未发布：直接修复，保持版本号
- 如果已发布：创建新的 patch 版本

---

## 参考文档

- [skill-standards.md](skill-standards.md) - 了解 SKILL.md 格式规范和元信息标准

- [skill-standards.md](skill-standards.md) - 标准化检验流程（详见"标准化检验流程"和"修改后专项检验"章节）
